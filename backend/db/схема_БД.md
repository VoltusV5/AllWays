<br><br>

# Таблица: users (Пользователи)

name           | type      | description
---------------|-----------|------------------------------------------
id             | INT (PK)  | Уникальный идентификатор пользователя
email    | VARCHAR   | Электронная почта пользователя
password_hash  | VARCHAR   | Хэш пароля пользователя
is_active      | BOOLEAN   | Флаг активности (TRUE = пользователь может входить в систему, то есть он не забанен, его аккаунт актуален)
created_at     | DATETIME      | Дата создания пользователя
updated_at     | DATETIME      | Дата последнего изменения записи
last_login     | DATETIME  | Время последнего успешного входа
failed_attempts| INT       | Количество неудачных попыток входа
email_verified | BOOLEAN   | Подтверждён ли email

<br><br><br><br>

# Таблица: social_logins (вход через другие сервисы)
name           | type      | description
---------------|-----------|------------------------------------------
id             | INT (PK) | ID операции
user_id        | INT (FK) | Ссылка на пользователя
provider       | VARCHAR  | Название сервиса (Google, VK, Yandex, Mail.ru, etc.)
provider_id    | VARCHAR  | ID пользователя в сервисе
created_at     | DATETIME | Дата и время подключения

<br><br><br><br>

# Таблица: login_history (отслеживание входов)
name           | type      | description
---------------|-----------|------------------------------------------
id        | INT (PK)    | айди входа
user_id   | INT (FK) → users.id
login_at  | DATETIME    | время
ip        | VARCHAR     | айпи
device    | VARCHAR     | устройство
browser   | VARCHAR     | браузер
success   | BOOLEAN     | статус входа

<br><br><br><br>

# Таблица: notifications (уведомления, личные сообщения пользователю)
name           | type      | description
---------------|-----------|------------------------------------------
id           | INT (PK) | айди уведомления
user_id      | INT (FK) → users.id
type         | VARCHAR  | (info, booking_update, promo, reminder)
message      | TEXT     | текст сообщения
related_id   | INT      | (например, booking_id, route_id)
created_at   | DATETIME | когда отправлен
read         | BOOLEAN  | прочитан или нет

<br><br><br><br>

# Таблица: user_routes(история поездок пользователя)
name  | type      | description
------|-----------|-----------------------------------
id    | INT (PK)  | ID для истории поездки
user_id      | INT (FK)  | Ссылка на пользователя
route_type   | VARCHAR   | Тип маршрута (from_to = откуда→куда, to_only = только куда)
start_stop   | INT (FK)  | Ссылка на stop_from (для from_to)
end_stop     | INT (FK)  | Ссылка на stop_to
created_at   | DATETIME  | Время выбора маршрута
duration     | INT       | Время в пути (в минутах)
distance_km  | INT       | Расстояние сегмента в километрах

<br><br><br><br>

# Таблица: profiles (Личные данные пользователя)
name       | type       | description
-----------|------------|--------------------------------------
user_id    | INT (PK, FK)| Ссылка на пользователя (users.id), один к одному
full_name  | VARCHAR    | Полное имя пользователя
birthday   | DATE       | Дата рождения пользователя
timezone   | VARCHAR    | Часовой пояс пользователя
preferences| JSON       | Настройки аккаунта пользователя 
account_level | INT (FK)| Уровень аккаунта (Gold, Silver, Bronze и т.д.)

<br><br><br><br>

# Таблица: account_levels (уровень аккаунта)
name  | type      | description
------|-----------|-----------------------------------
id            | INT (PK)  |
name          | VARCHAR   | Название уровня (Gold, Silver, Bronze)
description   | TEXT      | Описание преимуществ уровня
bonus_percent | INT       | Процент бонусов или скидки




<br><br><br><br>

# Таблица: bookings (Данные о бронировании, сюда записываются все билеты)
name             | type      | description
-----------------|-----------|-----------------------------------------
id   | INT (PK)  | Уникальный идентификатор бронирования
user_id          | INT (FK)  | Пользователь, оформивший бронирование
created_at       | DATETIME  | Дата и время создания бронирования
status           | VARCHAR   | Статус бронирования (новое, оплачено, отменено)
booking_expiry   | DATETIME  | Время, до которого бронирование действительно
group_booking_id | INT       | Ссылка на групповое бронирование
price_applied    | JSON      | Что применялось для цены ({"promo": true, "loyalty": false})

<br><br><br><br>

# Таблица: booking_pricing (финансовая часть брони)
name             | type      | description
-----------------|-----------|-----------------------------------------
id               | INT (PK)  | Уникальный идентификатор записи
booking_id       | INT (FK)  | Ссылка на бронирование (bookings.id)
base_price       | DECIMAL   | Базовая стоимость
discount_amount  | DECIMAL   | Скидка (в абсолютном значении)
final_price      | DECIMAL   | Итоговая сумма после скидок
currency         | VARCHAR   | Валюта (RUB, USD и т.п.)

<br><br><br><br>

# Таблица: booking_details (детали по билетам)
name             | type      | description
-----------------|-----------|-----------------------------------------
id               | INT (PK)  |
booking_id       | INT (FK)  | Ссылка на бронирование (bookings.id)
seat_class       | VARCHAR   | Класс билета (эконом, бизнес, первый)
luggage_info     | TEXT      | Информация о багаже

<br><br><br><br>

# Таблица: rewards (объединение промокодов и лояльности)
name                | type       | description                                          
--------------------|------------|------------------------------------
id                  | INT (PK)   | Уникальный идентификатор награды                     
type                | ENUM       | Тип награды: `promo` или `loyalty`                   
name                | VARCHAR    | Название награды                                     
description         | TEXT       | Описание награды                                     
created_at          | DATETIME   | Дата и время создания                                
updated_at          | DATETIME   | Дата и время последнего обновления   

<br><br><br><br>

# Таблица: promo_rewards
name                | type       | description                                          
--------------------|------------|---------------------------------------
id                  | INT (PK)   | Уникальный идентификатор промо-награды               
reward_id           | INT (FK)   | Ссылка на rewards.id                                 
coupon_code         | VARCHAR    | Промокод                                             
valid_until         | DATETIME   | Срок действия промо-награды                          
usage_limit         | INT        | Лимит использования                                  

<br><br><br><br>

# loyalty_rewards
name                | type       | description                                         
--------------------|------------|---------------------------------------------
id                  | INT (PK)   | Уникальный идентификатор награды лояльности          
reward_id           | INT (FK)   | Ссылка на rewards.id                                 
earn_rate           | DECIMAL    | Коэффициент начисления баллов                        
redeem_rate         | DECIMAL    | Коэффициент списания баллов                          
min_points_required | INT        | Минимальное количество баллов для использования      

<br><br><br><br>

# user_loyalty_balance
name                | type       | description                                          
--------------------|------------|------------------------------------
id                  | INT (PK)   | Уникальный идентификатор записи                      
user_id             | INT (FK)   | Ссылка на пользователя (users.id)                   
points_balance      | INT        | Текущий баланс баллов                                
last_updated        | DATETIME   | Дата последнего обновления                           

<br><br><br><br>



# Таблица: bookings_history (История изменений бронирования)
name        | type      | description
------------|-----------|-----------------------------------------
booking_id      | INT (FK)  | Ссылка на бронирование (bookings.id)
changed_at      | DATETIME  | Время изменения
changed_by      | INT (FK)  | Кто сделал изменение (user_id)
change_type     | VARCHAR   | Тип изменения (создание, изменение, отмена)
old_status      | VARCHAR   | Старый статус
new_status      | VARCHAR   | Новый статус

<br><br><br><br>

# Таблица: tickets (данные билетов бронирования)
name           | type      | description
---------------|-----------|------------------------------------------
id             | INT (PK)  | Уникальный идентификатор билета
booking_id     | INT (FK)  | Ссылка на бронирование (bookings.id)
passenger_name | VARCHAR   | Имя пассажира
seat_number    | VARCHAR   | Номер места (если применимо)
issued_at      | DATE      | Дата выдачи билета
schedule_id    | INT (FK)  | ID маршрута

<br><br><br><br>

# Таблица: payments (Оплата билетов)
name        | type      | description
------------|-----------|-----------------------------------------
id          | INT (PK)  | Уникальный идентификатор платежа
booking_id  | INT (FK)  | Ссылка на бронирование (bookings.id)
amount      | DECIMAL | Сумма платежа в минимальных единицах (например, копейки)
status      | VARCHAR   | Статус платежа (ожидается, успешен, отклонен)
paid_at     | DATE      | Дата и время оплаты
payment_method  | VARCHAR   | Метод оплаты (карта, кошелёк, бонусы)
currency        | VARCHAR   | Валюта платежа (например, RUB, USD)
refund_status   | VARCHAR   | возврат (pending, completed, failed).
transaction_id  | VARCHAR   | ID платежа в системе.
payment_gateway | VARCHAR   | через какую систему прошёл платёж (Stripe, PayPal, Яндекс и т.п.).
loyalty_points_used | INT   | сколько бонусных баллов применил пользователь.
created_at |  DATETIME  | Момент создания записи
updated_at |  DATETIME  | Момент обновления записи

<br><br><br><br>

# Таблица: user_files (Оплата билетов)
name        | type      | description
------------|-----------|-----------------------------------------
id |(PK)|
user_id |(FK → users.id)|
booking_id |(FK → bookings.id, NULLABLE)| — если файл относится к бронированию
review_id |(FK → reviews.id, NULLABLE)| — если файл относится к отзыву
file_url |(TEXT)| — путь до файла (S3, локально и т.п.)
file_type |(VARCHAR)| — image, pdf, doc
uploaded_at |(TIMESTAMP, DEFAULT now())|

<br><br><br><br>

# Таблица: providers (Данные перевозчика)
name         | type      | description
-------------|-----------|------------------------------------------
id           | INT (PK)  | Уникальный идентификатор перевозчика
name         | VARCHAR   | Название транспортной компании
contact_info | VARCHAR   | Контактная информация (телефон, email)

<br><br><br><br>

# Таблица: routes (Маршруты)
name         | type      | description
-------------|-----------|------------------------------------------
id           | INT (PK)  | Уникальный идентификатор маршрута
provider_id  | INT (FK)  | Ссылка на перевозчика (providers.id)
name         | VARCHAR   | Название маршрута (например: Москва–СПб)

<br><br><br><br>

# Таблица: stops (Остановки у маршрута: конечная и начальная точка сегмента)
name      | type    | description
----------|---------|-----------------------------------
id        | INT (PK)| Уникальный идентификатор остановки
name      | VARCHAR | Название остановки
latitude  | VARCHAR | Географическая широта
longitude | VARCHAR | Географическая долгота

<br><br><br><br>

# Таблица: segments (Сегменты для маршрута)
name         | type      | description
-------------|-----------|------------------------------------------
id           | INT (PK)  | Уникальный идентификатор сегмента маршрута
route_id     | INT (FK)  | Ссылка на маршрут (routes.id)
stop_from_id | INT (FK)  | Начальная остановка (stops.id)
stop_to_id   | INT (FK)  | Конечная остановка (stops.id)
duration     | INT       | Время в пути (в минутах)
distance_km  | INT       | Расстояние сегмента в километрах

<br><br><br><br>

# Таблица: segment_transport (конкретная информация о перевозчике, транспорте и стоимости сегмента)
name           | type      | description
------------   |-----------|-----------------------------------------
id             | INT (PK)  | ID сегмента
segment_id     | INT (FK) → segments.id
provider_id    | INT (FK) → providers.id
transport_type | VARCHAR   | Тип транспорта
price          | INT       | Цена сегмента маршрута
distance_actual    | INT   | оставшаяся дистанция сегмента маршрута
duration_actual   | INT    | оставшееся время поездки для сегмента маршрута
segment_status | VARCHAR   | статус сегмента (активный, отменённый, задержан).

<br><br><br><br>

# Таблица: schedules (таблица, соединяющая разные сегменты маршрута)
name           | type      | description
---------------|-----------|------------------------------------------
id             | INT (PK)  | Уникальный идентификатор записи расписания
segment_id     | INT (FK)  | Ссылка на сегмент маршрута (segments.id)
departure_time | DATETIME  | Время отправления
arrival_time   | DATETIME  | Время прибытия

<br><br><br><br>

# Таблица: audit_logs (отслеживания действий в системе (важно для безопасности, админки и расследований))
name           | type      | description
---------------|-----------|------------------------------------------
id (PK) |
user_id |(FK → users.id) |— кто совершил действие
action |(VARCHAR) | — какое действие (создал бронирование, изменил, отменил и т.п.)
entity_type| (VARCHAR)| — над какой сущностью (booking, payment, route)
entity_id |(INT)| — ID сущности
timestamp| DATETIME |
ip_address| (VARCHAR)| — IP
device_info| (VARCHAR)| — устройство / браузер

<br><br><br><br>

# Таблица: route_reviews (отзывы на маршруты)
name           | type      | description
---------------|-----------|------------------------------------------
id             | INT (PK)  | ID отзыва
route_id       | INT (FK) → routes.id
user_id        | INT (FK) → users.id
rating         | INT       | Рейтинг маршрута
review         | TEXT      | Комментарий отзыва
created_at     | DATETIME  | дата создания отзыва

# Таблица review_files (медиа для отзывов)
name           | type      | description
---------------|-----------|----------------------------------
id           | INT (PK)    | Уникальный идентификатор файла          
review_id    | INT (FK)    | Ссылка на отзыв                         
file_url     | TEXT        | Путь к файлу                             
file_type    | VARCHAR     | Тип файла (image, pdf, doc)             
uploaded_at  | TIMESTAMP   | Дата загрузки                            

